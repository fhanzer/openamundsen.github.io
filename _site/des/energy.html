<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Energy and mass balance - openAMUNDSEN</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Energy and mass balance | openAMUNDSEN</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Energy and mass balance" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/des/energy" /> <meta property="og:url" content="http://localhost:4000/des/energy" /> <meta property="og:site_name" content="openAMUNDSEN" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Energy and mass balance" /> <script type="application/ld+json"> {"url":"http://localhost:4000/des/energy","headline":"Energy and mass balance","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> openAMUNDSEN </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">openAMUNDSEN</a></li><li class="nav-list-item"><a href="http://localhost:4000/news/" class="nav-list-link">News</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/des/" class="nav-list-link">Description</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/des/structure" class="nav-list-link">Model structure</a></li><li class="nav-list-item "><a href="http://localhost:4000/des/meteo" class="nav-list-link">Processing meteo data</a></li><li class="nav-list-item "><a href="http://localhost:4000/des/radiation" class="nav-list-link">Radiation modeling</a></li><li class="nav-list-item "><a href="http://localhost:4000/des/precipitation" class="nav-list-link">Precipitation correction</a></li><li class="nav-list-item active"><a href="http://localhost:4000/des/energy" class="nav-list-link active">Energy and mass balance</a></li><li class="nav-list-item "><a href="http://localhost:4000/des/canopy" class="nav-list-link">Inside canopy</a></li><li class="nav-list-item "><a href="http://localhost:4000/des/lateral" class="nav-list-link">Lateral snow redistribution</a></li><li class="nav-list-item "><a href="http://localhost:4000/des/evapotranspiration" class="nav-list-link">Evapotranspiration</a></li><li class="nav-list-item "><a href="http://localhost:4000/des/runoff" class="nav-list-link">Runoff</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/doc/" class="nav-list-link">Documentation</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/doc/installation" class="nav-list-link">Installation</a></li><li class="nav-list-item "><a href="http://localhost:4000/doc/input" class="nav-list-link">Input data</a></li><li class="nav-list-item "><a href="http://localhost:4000/doc/configuration" class="nav-list-link">Configuration</a></li><li class="nav-list-item "><a href="http://localhost:4000/doc/runningthemodel" class="nav-list-link">Running the model</a></li><li class="nav-list-item "><a href="http://localhost:4000/doc/output" class="nav-list-link">Output data</a></li><li class="nav-list-item "><a href="http://localhost:4000/doc/exampledata" class="nav-list-link">Example data sets</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/demo/" class="nav-list-link">Live demo</a></li><li class="nav-list-item"><a href="http://localhost:4000/publications/" class="nav-list-link">Publications</a></li><li class="nav-list-item"><a href="http://localhost:4000/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search openAMUNDSEN" aria-label="Search openAMUNDSEN" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/des/">Description</a></li> <li class="breadcrumb-nav-list-item"><span>Energy and mass balance</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="calculating-the-energy-and-mass-balance-of-snow-and-ice"> <a href="#calculating-the-energy-and-mass-balance-of-snow-and-ice" class="anchor-heading" aria-labelledby="calculating-the-energy-and-mass-balance-of-snow-and-ice"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Calculating the energy and mass balance of snow and ice </h1> <p>Generally, the energy balance of a snowpack can be expressed as:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	Q + H + E + P + G = C + M

	Q = net radiation
	H = sensible heat flux
	E = latent heat flux
	P = advective heat flux caused by precipitation
	G = ground heat flux
	C = energy transferred to temperature changes within the snowpack
	M = energy transferred to snow melt
</code></pre></div></div> <h2 id="energy-balance-in-openamundsen"> <a href="#energy-balance-in-openamundsen" class="anchor-heading" aria-labelledby="energy-balance-in-openamundsen"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Energy balance in openAMUNDSEN </h2> <p>Two different layering schemes (“Cryolayers” / “Multilayer”) are implemented in the model. The energy balance calculation depends on the selected layering scheme.</p> <h3 id="snow-layering-scheme-cryolayers"> <a href="#snow-layering-scheme-cryolayers" class="anchor-heading" aria-labelledby="snow-layering-scheme-cryolayers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Snow layering scheme “Cryolayers” </h3> <p>“Cryolayers” is a bulk-layering scheme using separate layers for new snow, old snow, firn and ice. When using this scheme, the snowpack is taken as one layer to solve its energy balance. If air temperature rises above 0° C the model assumes that melting processes are possible and checks for a positive surface energy balance. If the surface energy balance is positive, melting processes occur where the melt amount is determined by the simulated available excess energy. If the air temperature is below 0°C, an iterative procedure to compute the snow surface temperature needed for closing the energy balance is applied. In this procedure, the snow surface temperature is altered until the residual energy balance passes zero.</p> <h3 id="snow-layering-scheme-multilayer"> <a href="#snow-layering-scheme-multilayer" class="anchor-heading" aria-labelledby="snow-layering-scheme-multilayer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Snow layering scheme “Multilayer” </h3> <p>“Multilayer” is a scheme that divides the snowpack in distinct layers to calculate heat fluxes within the snow pack (Essery 2015). To solve the energy balance within this scheme, in a first step, melt is assumed to be 0 for the surface temperature change of every timestep. If the energy balance results in a surface temperature above 0° C, snow is melting. The temperature increment has to be recalculated assuming that all of the snow melts. If this results in a surface temperature below 0°C, snow melts only partially during the timestep (Essery 2015).</p> <h2 id="choose-and-configure-method-in-openamundsen"> <a href="#choose-and-configure-method-in-openamundsen" class="anchor-heading" aria-labelledby="choose-and-configure-method-in-openamundsen"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Choose and configure method in openAMUNDSEN </h2> <h3 id="cryolayers-scheme"> <a href="#cryolayers-scheme" class="anchor-heading" aria-labelledby="cryolayers-scheme"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> “Cryolayers” scheme </h3> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Snow parameters</span>
<span class="na">snow</span><span class="pi">:</span>
  <span class="na">model</span><span class="pi">:</span> <span class="s">cryolayers</span> <span class="c1"># snow scheme (multilayer or cryolayers)</span>
  <span class="na">thermal_conductivity</span><span class="pi">:</span> <span class="m">0.24</span> <span class="c1"># snow thermal conductivity (W m-1 K-1)</span>
  <span class="na">roughness_length</span><span class="pi">:</span> <span class="m">0.01</span> <span class="c1"># roughness length of snow-covered ground (m)</span>
  <span class="na">measurement_height_adjustment</span><span class="pi">:</span> <span class="no">false</span> <span class="c1"># adjust the temperature measurement height for snow depth</span>
  <span class="na">snow_cover_fraction_depth_scale</span><span class="pi">:</span> <span class="s">1.e-6</span> <span class="c1"># snow cover fraction depth scale (m)</span>
  <span class="na">cryolayers</span><span class="pi">:</span>
    <span class="na">cold_holding_capacity</span><span class="pi">:</span> <span class="m">0.05</span> <span class="c1"># cold holding capacity (as a fraction of the layer SWE) and refreezing factor for the cold content approach by Braun (1984)</span>
    <span class="na">refreezing_factor</span><span class="pi">:</span> <span class="s">1.</span> <span class="c1"># fraction of available energy that is used for building up cold content and refreezing liquid water</span>
    <span class="na">surface_heat_flux</span><span class="pi">:</span> <span class="s">-2.</span> <span class="c1"># surface heat flux for snow-covered conditions (W m-2)</span>
    <span class="na">transition</span><span class="pi">:</span>
      <span class="na">old_snow</span><span class="pi">:</span> <span class="s">200.</span> <span class="c1"># new snow -&gt; old snow transition (density, kg m-3)</span>
      <span class="na">firn</span><span class="pi">:</span> <span class="m">10</span> <span class="c1"># old snow -&gt; firn transition (calendar month)</span>
      <span class="na">ice</span><span class="pi">:</span> <span class="s">900.</span> <span class="c1"># firn -&gt; ice transition (density, kg m-3)</span>
</code></pre></div></div> <h3 id="multilayer-scheme"> <a href="#multilayer-scheme" class="anchor-heading" aria-labelledby="multilayer-scheme"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> “Multilayer” scheme </h3> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Snow parameters</span>
<span class="na">snow</span><span class="pi">:</span>
  <span class="na">model</span><span class="pi">:</span> <span class="s">multilayer</span> <span class="c1"># snow scheme (multilayer or cryolayers)</span>
  <span class="na">thermal_conductivity</span><span class="pi">:</span> <span class="m">0.24</span> <span class="c1"># snow thermal conductivity (W m-1 K-1)</span>
  <span class="na">roughness_length</span><span class="pi">:</span> <span class="m">0.01</span> <span class="c1"># roughness length of snow-covered ground (m)</span>
  <span class="na">measurement_height_adjustment</span><span class="pi">:</span> <span class="no">false</span> <span class="c1"># adjust the temperature measurement height for snow depth</span>
  <span class="na">snow_cover_fraction_depth_scale</span><span class="pi">:</span> <span class="s">1.e-6</span> <span class="c1"># snow cover fraction depth scale (m)</span>
</code></pre></div></div> <h3 id="general-snow-and-energy-balance-related-model-parameters"> <a href="#general-snow-and-energy-balance-related-model-parameters" class="anchor-heading" aria-labelledby="general-snow-and-energy-balance-related-model-parameters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> General snow and energy-balance related model parameters </h3> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Snow parameters</span>
<span class="na">snow</span><span class="pi">:</span>
  <span class="c1"># Albedo parameters</span>
  <span class="na">albedo</span><span class="pi">:</span>
    <span class="na">method</span><span class="pi">:</span> <span class="s">snow_age</span>
    <span class="na">min</span><span class="pi">:</span> <span class="m">0.55</span> <span class="c1"># minimum snow albedo</span>
    <span class="na">max</span><span class="pi">:</span> <span class="m">0.85</span> <span class="c1"># maximum snow albedo</span>
    <span class="na">firn</span><span class="pi">:</span> <span class="m">0.4</span> <span class="c1"># firn albedo (constant)</span>
    <span class="na">ice</span><span class="pi">:</span> <span class="m">0.2</span> <span class="c1"># ice albedo (constant)</span>
    <span class="na">cold_snow_decay_timescale</span><span class="pi">:</span> <span class="m">480</span> <span class="c1"># albedo decay timescale for cold (T &lt; 0 °C) snow (h)</span>
    <span class="na">melting_snow_decay_timescale</span><span class="pi">:</span> <span class="m">200</span> <span class="c1"># albedo decay timescale for melting snow (h)</span>
    <span class="na">decay_timescale_determination_temperature</span><span class="pi">:</span> <span class="s">surface</span> <span class="c1"># use surface temperature to distinguish between cold and melting snow</span>
    <span class="na">refresh_snowfall</span><span class="pi">:</span> <span class="m">0.5</span> <span class="c1"># snowfall amount for resetting albedo to the maximum value (kg m-2 h-1)</span>
    <span class="na">refresh_method</span><span class="pi">:</span> <span class="s">binary</span> <span class="c1"># binary or continuous</span>

  <span class="c1"># Snow compaction parameters</span>
  <span class="na">compaction</span><span class="pi">:</span>
    <span class="na">method</span><span class="pi">:</span> <span class="s">anderson</span> <span class="c1"># anderson or empirical</span>

    <span class="c1"># Parameters for method "empirical"</span>
    <span class="na">timescale</span><span class="pi">:</span> <span class="m">200</span> <span class="c1"># snow compaction timescale (h)</span>
    <span class="na">max_cold_density</span><span class="pi">:</span> <span class="m">300</span> <span class="c1"># maximum density for cold (T &lt; 0 °C) snow (kg m-3)</span>
    <span class="na">max_melting_density</span><span class="pi">:</span> <span class="m">500</span> <span class="c1"># maximum density for melting snow (kg m-3)</span>

  <span class="c1"># Liquid water content parameters</span>
  <span class="na">liquid_water_content</span><span class="pi">:</span>
    <span class="na">method</span><span class="pi">:</span> <span class="s">pore_volume_fraction</span> <span class="c1"># pore_volume_fraction or mass_fraction</span>
    <span class="na">max</span><span class="pi">:</span> <span class="m">0.03</span> <span class="c1"># maximum liquid water content as a fraction of the total pore volume or mass</span>

  <span class="c1"># Melt parameters</span>
  <span class="na">melt</span><span class="pi">:</span>
    <span class="na">method</span><span class="pi">:</span> <span class="s">energy_balance</span> <span class="c1"># melt method (energy_balance, temperature_index or enhanced_temperature_index)</span>
    <span class="na">threshold_temp</span><span class="pi">:</span> <span class="m">273.15</span> <span class="c1"># threshold temperature for the temperature index methods (K)</span>
    <span class="na">degree_day_factor</span><span class="pi">:</span> <span class="m">1.2</span> <span class="c1"># degree day factor for the temperature index methods (kg m-2 d-1 K-1)</span>
    <span class="na">albedo_factor</span><span class="pi">:</span> <span class="m">0.1</span> <span class="c1"># albedo factor for the enhanced temperature index method (m2 kg m-2 W-1 d-1)</span>

</code></pre></div></div> <h2 id="references"> <a href="#references" class="anchor-heading" aria-labelledby="references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> References </h2> <ul> <li> <p>Essery, R. (2015). A factorial snowpack model (FSM 1.0). Geoscientific Model Development, 8(12), 3867–3876. https://doi.org/10.5194/gmd-8-3867-2015</p> </li> <li> <p>Strasser, U. (2008). Modelling of the mountain snow cover in the Berchtesgaden National Park, Tech. Rep. 55, Berchtesgaden National Park, Berchtesgaden.</p> </li> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
